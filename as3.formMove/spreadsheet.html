<!DOCTYPE html>
<html>
<head>
<title>Spreadsheet</title>
<style type="text/css">
  td {
    padding:3px;
  }
</style>
</head>

<body>
<table border="0" cellpadding="0" cellspacing="0">
  <thead>
    <tr>
      <th>Name</th>
      <th>Student ID</th>
      <th>Faculty</th>
      <th>Major</th>
      <th>Minor</th>
      <th>Year</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody id="body">
    <tr onclick="shine(this)">
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td>
        <button onclick="up(this)">Up</button>
        <button onclick="dn(this)">Dn</button>
        <button onclick="del(this)">Del</button>
      </td>
    </tr>
    <tr onclick="shine(this)">
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td>
        <button onclick="up(this)">Up</button>
        <button onclick="dn(this)">Dn</button>
        <button onclick="del(this)">Del</button>
      </td>
    </tr>
    <tr onclick="shine(this)">
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td><input type="text" /></td>
      <td>
        <button onclick="up(this)">Up</button>
        <button onclick="dn(this)">Dn</button>
        <button onclick="del(this)">Del</button>
      </td>
    </tr>
  </tbody>
</table>
<button id="newRowBtn" onclick="addrow()">New row</button>
<script>
function addrow(){
  var row=document.createElement("tr");
  row.setAttribute("onclick","shine(this)");
  for(i=0;i<6;i++){
    var td=document.createElement("td");
    var tnode = document.createElement("input");
    tnode.setAttribute("type","text");
    td.appendChild(tnode);
    row.appendChild(td);
  }
  var td=document.createElement("td");
  var btn=document.createElement("button");
  var text=document.createTextNode("Up");
  btn.setAttribute("onclick","up(this)")
  btn.appendChild(text);
  td.appendChild(btn);
  td.appendChild(document.createTextNode(" "));

  var btn2=document.createElement("button");
  var text2=document.createTextNode("Dn");
  btn2.setAttribute("onclick","dn(this)")
  btn2.appendChild(text2);
  td.appendChild(btn2);
  td.appendChild(document.createTextNode(" "));

  var btn3=document.createElement("button");
  var text3=document.createTextNode("Del");
  btn3.setAttribute("onclick","del(this)")
  btn3.appendChild(text3);
  td.appendChild(btn3);

  row.appendChild(td);
  document.getElementById("body").append(row);
}

function del(el){
  var cur=el;
  var parent=cur.parentNode;
  var grandpa=parent.parentNode;
  grandpa.remove();
}
function up(el){
  var cur=el;
  var parent=cur.parentNode;
  var grandpa=parent.parentNode;
  if(grandpa.rowIndex!=1){
    var pre=grandpa.previousElementSibling;
    console.log("-------");
    console.log("curr:",grandpa);
    console.log("prev:",pre);
    document.getElementById("body").insertBefore(grandpa,pre);
  }
}
function dn(el){
  var cur=el;
  var parent=cur.parentNode;
  var grandpa=parent.parentNode;
  if(grandpa.nextSibling!=null){
    var next=grandpa.nextElementSibling;
    var nextnext=next.nextElementSibling;
    document.getElementById("body").insertBefore(grandpa,nextnext);
  }
}
function shine(el){
  var elements=document.getElementsByTagName('tr');
  for(i=0;i<elements.length;i++){
    elements[i].style.backgroundColor="white";
  }
  el.style.backgroundColor="yellow";

}

</script>
</body>

</html>
